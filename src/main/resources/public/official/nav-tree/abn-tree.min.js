(function(){angular.module("angularBootstrapNavTree",[]).directive("abnTree",["$timeout",function(n){return{restrict:"E",templateUrl:function(n,e){var t="official/nav-tree/abn-tree.tpl.html";return e.templateUrl&&e.templateUrl.length>0&&(t=e.templateUrl),t},replace:!0,scope:{treeData:"=",onSelect:"&",onToggle:"&",initialSelection:"@",treeControl:"="},link:function(e,t,r){var l,a,u,i,o,c,f,s,d,_;if(function(n){},null==r.iconExpand&&(r.iconExpand=" add "),null==r.iconCollapse&&(r.iconCollapse="remove"),null==r.iconLeaf&&(r.iconLeaf="isLeaf"),null==r.expandLevel&&(r.expandLevel="2"),a=parseInt(r.expandLevel,10),e.treeData){if(null==e.treeData.length){if(null==treeData.title)return void alert("treeData should be an array of root branches");e.treeData=[treeData]}return i=function(n){var t,r,l,a,u,i;for(t=function(e,r){var l,a,u,i,o;if(n(e,r),null!=e.nodes){for(o=[],a=0,u=(i=e.nodes).length;a<u;a++)l=i[a],o.push(t(l,r+1));return o}},i=[],l=0,a=(u=e.treeData).length;l<a;l++)r=u[l],i.push(t(r,1));return i},d=null,s=function(t){if(!t)return null!=d&&(d.selected=!1),void(d=null);if(t!==d||!t.selected){if(null!=d&&(d.selected=!1),t.selected=!0,d=t,l(t),null!=t.onSelect)return n(function(){return t.onSelect(t)});if(null!=e.onSelect)return n(function(){return e.onSelect({branch:t})})}},e.user_clicks_branch=function(n){if(n!=d||!n.selected)return s(n)},e.toggleBranch=function(n){n.expanded=!n.expanded,e.onToggle({branch:n})},o=function(n){var e;return e=void 0,n.parent_uid&&i(function(t){if(t.uid===n.parent_uid)return e=t}),e},u=function(n,e){var t;if(null!=(t=o(n)))return e(t),u(t,e)},l=function(n){return u(n,function(n){return n.expanded=!0})},e.tree_rows=[],f=function(){var n,t,l,a,u,o;for(i(function(n,e){if(!n.uid)return n.uid=""+Math.random()}),i(function(n){var e,t,r,l,a;if(angular.isArray(n.nodes)){for(a=[],t=0,r=(l=n.nodes).length;t<r;t++)e=l[t],a.push(e.parent_uid=n.uid);return a}}),e.tree_rows=[],i(function(n){var e,t;return n.nodes?n.nodes.length>0?(t=function(n){return"string"==typeof n?{title:n,nodes:[]}:n},n.nodes=function(){var r,l,a,u;for(u=[],r=0,l=(a=n.nodes).length;r<l;r++)e=a[r],u.push(t(e));return u}()):void 0:n.nodes=[]}),n=function(t,l,a){var u,i,o,c,f,s,d;if(null==l.expanded&&(l.expanded=!1),o=l.hasOwnProperty("noLeaf")?l.noLeaf?l.expanded?r.iconCollapse:r.iconExpand:r.iconLeaf:l.nodes&&0!==l.nodes.length?l.expanded?r.iconCollapse:r.iconExpand:r.iconLeaf,e.tree_rows.push({level:t,branch:l,title:l.title,tree_icon:o,visible:a}),null!=l.nodes){for(d=[],c=0,f=(s=l.nodes).length;c<f;c++)u=s[c],i=a&&l.expanded,d.push(n(t+1,u,i));return d}},o=[],l=0,a=(u=e.treeData).length;l<a;l++)t=u[l],o.push(n(1,t,!0));return o},e.$watch("treeData",f,!0),null!=r.initialSelection&&i(function(e){if(e.title===r.initialSelection)return n(function(){return s(e)})}),c=e.treeData.length,i(function(n,e){return n.level=e,n.expanded=n.level<a}),null!=e.treeControl&&angular.isObject(e.treeControl)?(_=e.treeControl,_.expand_all=function(){return i(function(n,e){return n.expanded=!0})},_.collapse_all=function(){return i(function(n,e){return n.expanded=!1})},_.get_roots=function(){var n=[];return i(function(e,t){1===t&&n.push(e)}),n},_.get_first_branch=function(){if((c=e.treeData.length)>0)return e.treeData[0]},_.select_first_branch=function(){var n;return n=_.get_first_branch(),_.select_branch(n)},_.get_selected_branch=function(){return d},_.get_parent_branch=function(n){return o(n)},_.select_branch=function(n){return s(n),n},_.get_children=function(n){return n.nodes},_.select_parent_branch=function(n){var e;if(null==n&&(n=_.get_selected_branch()),null!=n&&null!=(e=_.get_parent_branch(n)))return _.select_branch(e),e},_.add_branch=function(n,t){return null!=n?(n.nodes.push(t),n.expanded=!0):e.treeData.push(t),t},_.delete_branch_by_uid=function(n){var t;i(function(r,l){r.uid===n&&-1!=(t=e.treeData.indexOf(r))&&e.treeData.splice(t,1)})},_.delete_children=function(n){if(null!=n){var r,l;for(r=n.nodes.length-1;r>=0;r-=1)-1!=(l=e.treeData.indexOf(t))&&e.treeData.splice(l,1),n.nodes.splice(r,1);n.expanded=!1,n.noLeaf=!1}return n},_.add_root_branch=function(n){return _.add_branch(null,n),n},_.expand_branch=function(n){if(null==n&&(n=_.get_selected_branch()),null!=n)return n.expanded=!0,n},_.collapse_branch=function(n){if(null==n&&(n=d),null!=n)return n.expanded=!1,n},_.get_siblings=function(n){var t;if(null==n&&(n=d),null!=n)return t=_.get_parent_branch(n),t?t.nodes:e.treeData},_.get_next_sibling=function(n){var e,t;if(null==n&&(n=d),null!=n&&(t=_.get_siblings(n),c=t.length,(e=t.indexOf(n))<c))return t[e+1]},_.get_prev_sibling=function(n){var e,t;if(null==n&&(n=d),t=_.get_siblings(n),c=t.length,(e=t.indexOf(n))>0)return t[e-1]},_.select_next_sibling=function(n){var e;if(null==n&&(n=d),null!=n&&null!=(e=_.get_next_sibling(n)))return _.select_branch(e)},_.select_prev_sibling=function(n){var e;if(null==n&&(n=d),null!=n&&null!=(e=_.get_prev_sibling(n)))return _.select_branch(e)},_.get_first_child=function(n){var e;if(null==n&&(n=d),null!=n&&(null!=(e=n.nodes)?e.length:void 0)>0)return n.nodes[0]},_.get_closest_ancestor_next_sibling=function(n){var e,t;return e=_.get_next_sibling(n),null!=e?e:(t=_.get_parent_branch(n),_.get_closest_ancestor_next_sibling(t))},_.get_next_branch=function(n){var e;if(null==n&&(n=d),null!=n)return e=_.get_first_child(n),null!=e?e:e=_.get_closest_ancestor_next_sibling(n)},_.select_next_branch=function(n){var e;if(null==n&&(n=d),null!=n&&null!=(e=_.get_next_branch(n)))return _.select_branch(e),e},_.last_descendant=function(n){var e;return c=n.nodes.length,0===c?n:(e=n.nodes[c-1],_.last_descendant(e))},_.get_prev_branch=function(n){var e;if(null==n&&(n=d),null!=n)return e=_.get_prev_sibling(n),null!=e?_.last_descendant(e):_.get_parent_branch(n)},_.select_prev_branch=function(n){var e;if(null==n&&(n=d),null!=n&&null!=(e=_.get_prev_branch(n)))return _.select_branch(e),e}):void 0}alert("no treeData defined for the tree!")}}}])}).call(this);